<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Método da Bisseção</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    table {
      border-collapse: collapse;
      margin: auto;
    }
    td, th {
      border: 1px solid #444;
      padding: 4px 8px;
      text-align: center;
    }
    .step table {
      margin-top: 8px;
      border: 1px solid #444;
    }
  </style>
</head>
<body class="bg-black text-white font-sans min-h-screen flex flex-col items-center justify-center px-6">

  <!-- Container -->
  <div class="w-full max-w-6xl bg-neutral-900 rounded-2xl shadow-2xl p-8">

    <!-- Título -->
    <h1 class="text-3xl md:text-4xl font-bold text-center mb-6">
      <span class="bg-gradient-to-r from-fuchsia-500 to-orange-400 text-transparent bg-clip-text">
        Método da Bisseção
      </span>
    </h1>

    <!-- Descrição -->
    <p class="text-center text-gray-400 mb-8">
      Informe o grau do polinômio, seus coeficientes e a precisão desejada (ε).  
      O programa exibirá os intervalos com mudança de sinal e a raiz aproximada.
    </p>

    <!-- Form -->
    <div class="flex flex-col md:flex-row items-center justify-center gap-4 mb-6">
      <input
        id="grau"
        type="number"
        min="1"
        placeholder="Grau (ex: 3)"
        class="border border-gray-500 bg-black text-white px-4 py-2 rounded-lg focus:outline-none focus:border-fuchsia-500 w-32 text-center"
      />
      <input
        id="coeficientes"
        type="text"
        placeholder="Coeficientes (ex: 1,0,-9,3)"
        class="border border-gray-500 bg-black text-white px-4 py-2 rounded-lg focus:outline-none focus:border-orange-400 w-80 text-center"
      />
      <input
        id="epsilon"
        type="number"
        step="0.0001"
        placeholder="ε (ex: 0.01)"
        class="border border-gray-500 bg-black text-white px-4 py-2 rounded-lg focus:outline-none focus:border-green-400 w-32 text-center"
      />
      <button
        onclick="calcular()"
        class="bg-gradient-to-r from-fuchsia-500 to-orange-400 text-white px-6 py-2 rounded-full font-semibold shadow-lg transform transition duration-300 hover:scale-105 hover:opacity-90"
      >
        Calcular
      </button>
    </div>

    <!-- Output -->
    <div id="resultado" class="mt-8 grid gap-6 md:grid-cols-2 lg:grid-cols-3"></div>
  </div>

  <script>
    function calcularPolinomio(coefs, x) {
      return coefs.reduce((acc, coef, i) => acc + coef * Math.pow(x, coefs.length - 1 - i), 0);
    }

    function encontrarIntervalos(coefs, a, b, passo) {
      let intervalos = [];
      let xAtual = a;
      let fAnterior = calcularPolinomio(coefs, xAtual);

      while (xAtual < b) {
        let xProx = xAtual + passo;
        let fProx = calcularPolinomio(coefs, xProx);

        if (fAnterior * fProx < 0) {
          intervalos.push([xAtual, xProx]);
        }

        xAtual = xProx;
        fAnterior = fProx;
      }
      return intervalos;
    }

    function bissecao(coefs, a, b, epsilon) {
      let fa = calcularPolinomio(coefs, a);
      let fb = calcularPolinomio(coefs, b);
      let iteracoes = [];
      let x;

      if (fa * fb > 0) return null;

      while (Math.abs(b - a) > epsilon) {
        x = (a + b) / 2;
        let fx = calcularPolinomio(coefs, x);

        iteracoes.push({a, b, x, fx});

        if (fx === 0) break;

        if (fa * fx < 0) {
          b = x;
          fb = fx;
        } else {
          a = x;
          fa = fx;
        }
      }

      return {raiz: (a + b) / 2, iteracoes};
    }

    function calcular() {
      const grau = parseInt(document.getElementById("grau").value);
      const coefStr = document.getElementById("coeficientes").value;
      const epsilon = parseFloat(document.getElementById("epsilon").value);
      const resultadoDiv = document.getElementById("resultado");
      resultadoDiv.innerHTML = "";

      if (isNaN(grau) || grau < 1 || !coefStr || isNaN(epsilon) || epsilon <= 0) {
        resultadoDiv.innerHTML = "<p class='text-red-500 col-span-full text-center'>Preencha todos os campos corretamente.</p>";
        return;
      }

      const coefs = coefStr.split(",").map(Number);
      if (coefs.length !== grau + 1) {
        resultadoDiv.innerHTML = "<p class='text-red-500 col-span-full text-center'>Número de coeficientes não corresponde ao grau informado.</p>";
        return;
      }

      const a = -1000, b = 1000, passo = 1;
      const intervalos = encontrarIntervalos(coefs, a, b, passo);

      if (intervalos.length === 0) {
        resultadoDiv.innerHTML = "<p class='text-gray-300 col-span-full text-center'>Nenhum intervalo com mudança de sinal encontrado.</p>";
        return;
      }

      intervalos.forEach(([ini, fim], i) => {
        let res = bissecao(coefs, ini, fim, epsilon);
        if (res) {
          const card = document.createElement("div");
          card.className = "border border-gray-600 rounded-lg p-6 hover:border-fuchsia-500 transition transform hover:scale-105 bg-neutral-800";
          card.innerHTML = `
            <h3 class="text-lg font-bold mb-2">Intervalo ${i + 1}: [${ini}, ${fim}]</h3>
            <p class="text-gray-400 mb-4">Raiz aproximada: <span class="text-green-400 font-semibold">${res.raiz.toFixed(6)}</span></p>
            <h4 class="text-md font-semibold mb-2 text-orange-400">Iterações</h4>
            <div class="overflow-x-auto">
              <table>
                <tr><th>k</th><th>a</th><th>b</th><th>x</th><th>f(x)</th></tr>
                ${res.iteracoes.map((it, idx) => `
                  <tr>
                    <td>${idx + 1}</td>
                    <td>${it.a.toFixed(6)}</td>
                    <td>${it.b.toFixed(6)}</td>
                    <td>${it.x.toFixed(6)}</td>
                    <td>${it.fx.toExponential(4)}</td>
                  </tr>
                `).join("")}
              </table>
            </div>
          `;
          resultadoDiv.appendChild(card);
        }
      });
    }
  </script>
</body>
</html>
